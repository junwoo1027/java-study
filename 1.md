## 목표
자바 소스파일(.java)을 JVM으로 실행하는 과정 이해하기

## 학습할 것
- JVM이란 무엇인가
- 컴파일 하는 방법
- 실행하는 방법
- 바이트코드란 무엇인가
- JIT 컴파일러란 무엇이며 어떻게 동작하는지
- JVM 구성 요소
- JDK와 JRE의 차이

## JVM이란 무엇인가
JVM(Java Virtual Machine)이란, 자바를 실행하기 위한 가상 머신이다. 자바 애플리케이션은 모두 이 JVM을 통해 실행이 되게 때문에 자바 애플리케이션이 실행되려면 반드시 JVM이 필요하다.  
- 자바 애플리케이션은 JVM 위에서 동작하기 때문에 JVM에 종속적이나, os와 하드웨어에 종속적이 않다. 그렇기 때문에, 서로 다른 os나 하드웨어 환경에서도 프로그램의 변경없이 실행이 가능하다.  
- 자바 애플리케이션은 일반 애플리케이션과 비교해 jvm을 한 번 더 거치고 또, jvm이 프로그램 실행시에 인터프리터로 바이트코드를 한 줄씩 실행하기 때문에 속도가 느리다는 단점이 있다. (JIT 컴파일러로 속도의 갭을 줄인다.)  
- JVM은 내부의 GC(Garbage Collector)로 사용되지 않는 메모리를 정리해 메모리 관리를 해준다

실행 흐름 .java파일 작성 -> class파일로 컴파일 -> class파일을 JVM에서 실행  

※ Interpreter 방식: 명령어를 하나씩 수행 하는 방식  
※ JIT(Just In Time compiler) 방식: 전체 바이트코드를 네이티브 코드로 변환하고 그 이후에는  네이티브 코드로 실행하는 방식

## 바이트코드란
자바 가상 머신이 이해할 수 있는 언어로 변환된 자바 소스 코드, 자바 컴파일러로 변환되는 코드의 명령어 크기가 1바이트라서 바이트코드라고 불린다고 한다.  
다시 풀어서 이해하자면 자바는 OS에 종속적이지 않기 위해서 JVM 이 이해할 수 있는 언어인 바이트코드 형태로 제공되고 바이트코드와 JVM이 있으면 어느 운영체제에 종속적이지 않고 실행된다고 이해하면 된다.

## JIT 컴파일러란
기존 클래스파일(바이트코드)를 실행하는 방법은 Interpreter 방식이 기본이다. Interpreter 방식은 명령어를 하나씩 해석해서 처리하는 개념이기 때문에 명령어 하나하나 실행하는 속도는 빠를지 모르나 전체 코드 관점에서 보면 실행 속도가 느린 단점이 있다. 해당 문제를 해결하기 위해서 나온 방법이 JIT 컴파일러이고
JIT 컴파일러는 런타임 시 클래스파일(바이트코드)를 네이티브 기계어로 한방에 컴파일 후 사용하는 개념으로 이해하는 것이 편하다.  

좀 더 상세히 얘기하자면 전체 컴파일 후 캐싱 -> 이후 변경된 부분만 컴파일하고 나머지는 캐시에서 가져다가 바로 실행 이다. 바로 꺼내서 사용하고 변경 부분만 컴파일 하기 때문에 코드 수행속도가 Interpreter 방식에 비해서 빠르다

## JVM의 구성요소
JVM의 구성요소는 크게 세 군대로 나눌 수 있다. 클래스 로더, 메모리 영역, 실행 엔진이다.  

자바는 동적로드를 하기 때문에, 프로그램 실행 시점에 필요한 클래스를 처음 참조할 때마다 클래스를 로드하고 링크한다. 그럴 때 바이트코드를 읽어 클래스를 로더해 오는 것이 클래스 로더이다.  
물론 static은 컴파일 시점에 (인스턴스가 생성되기 전에) 다 읽어서 메모리에 올려둔다.  

메모리 영역은 프로그램이 실행되면서 JVM이 운영체제로부터 할당받은 메모리 공간이다. 스택 영역, PC, 네이티브 메소드 스택, 힙 영역, 메소드 영역이 있는데, 이 중 스택, PC, 네이티브 메소드 스택은 쓰레드마다 하나씩 생성된다. 그 외의 메모리 영역은 모든 쓰레드가 공유한다.
실행 엔진은 바이트코드를 읽고 실행하는 역할을 한다. 실행 엔진은 인터프리터와 JIT 컴파일러가 있다. 먼저 인터프리터는 바이트코드를 한 줄씩 읽고 실행해준다. JIT 컴파일러는 인터프리터가 실행한 코드를 캐싱하여 중복된 코드가 나올 때, 중복 번역을 방지해서 속도를 보안해준다.

## JDK와 JRE의 차이
JRE(Java Runtime Environment)는 자바 애플리케이션을 실행할 수 있도록 해주는 환경이다. 당연히 JVM이 포함되어 있으며, 개발 관련된 도구는 없다.  
JDK(Java Development Kit)는 자바 애플리케이션을 개발할 수 있도록 해주는 도구이다.




